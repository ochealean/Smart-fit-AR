<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Issue Reports - Shop Owner</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="/shopowner/css/issue_report.css">
    <link rel="icon" type="image/png" href="/images/smartfitImages/smartfitAR-logo.png">
    <script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
</head>

<body>
    <div class="dashboard">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-store"></i>
                </div>
                <span>SHOP DASHBOARD</span>
            </div>
            <div class="nav-items">
                <a href="/shopowner/html/shop_dashboard.html" class="nav-item">
                    <i class="fas fa-home"></i> Dashboard
                </a>
                <a href="/shopowner/html/shopowner_addshoe.html" class="nav-item">
                    <i class="fas fa-shoe-prints"></i> Add Shoe
                </a>
                <a href="/shopowner/html/shoeverification.html" class="nav-item">
                    <i class="fas fa-check-circle"></i> Shoe Verification
                </a>
                <a id="addemployeebtn" href="/shopowner/html/shopowner_addemployee.html" class="nav-item shopowner">
                    <i class="fas fa-users"></i> Add Employee
                </a>
                <a href="/shopowner/html/shop_inventory.html" class="nav-item">
                    <i class="fas fa-boxes"></i> Inventory
                </a>
                <a href="/shopowner/html/shop_order.html" class="nav-item">
                    <i class="fas fa-shopping-cart"></i> Orders
                </a>
                <a id="issuereport" href="/shopowner/html/issue_report.html" class="nav-item manager active">
                    <i class="fas fa-exclamation-circle"></i> Issue Report
                </a>
                <a id="analyticsbtn" href="/shopowner/html/analytics.html" class="nav-item manager">
                    <i class="fas fa-chart-line"></i> Analytics
                </a>
                <a href="/shopowner/html/shopprofile.html" class="nav-item">
                    <i class="fas fa-cog"></i> Settings
                </a>
                <a id="logout_btn" class="nav-item">
                    <i class="fas fa-sign-out-alt"></i> Logout
                </a>
            </div>
        </div>

        <!-- Main Content -->
        <div class="container">
            <div class="header">
                <!-- Mobile Menu Toggle -->
                <div class="mobile-menu-toggle">
                    <i class="fas fa-bars"></i>
                </div>
                <h1 class="animate-fade">Customer Issue Reports</h1>
                <div class="user-profile">
                    <img id="profilePicture" src="https://randomuser.me/api/portraits/women/45.jpg" alt="User" class="user-avatar">
                    <span id="userFullname">Shop Owner</span>
                </div>
            </div>

            <!-- Search and Filter -->
            <div class="search-container animate-fade">
                <input type="text" id="issueSearch" placeholder="Search issues by order ID, user ID, or type..."
                    class="search-input">
                <button id="searchBtn" class="search-btn">
                    <i class="fas fa-search"></i> Search
                </button>
                <button id="clearSearch" class="clear-btn">
                    <i class="fas fa-times"></i> Clear
                </button>
            </div>

            <!-- Issue Reports Table -->
            <div class="table-container animate-fade">
                <table>
                    <thead>
                        <tr>
                            <th><i class="fas fa-id-card-alt"></i> Report ID</th>
                            <th><i class="fas fa-receipt"></i> Order ID</th>
                            <th><i class="fas fa-user"></i> User ID</th>
                            <th><i class="fas fa-tag"></i> Issue Type</th>
                            <th><i class="fas fa-comment"></i> Description</th>
                            <th><i class="fas fa-images"></i> Photos</th>
                            <th><i class="fas fa-info-circle"></i> Status</th>
                            <th><i class="fas fa-calendar-alt"></i> Date Reported</th>
                            <th><i class="fas fa-cog"></i> Actions</th>
                        </tr>
                    </thead>
                    <tbody id="issueReportsTableBody">
                        <!-- Data will be inserted here -->
                    </tbody>
                </table>
            </div>

            <!-- Pagination -->
            <div class="pagination">
                <button class="pagination-btn" id="prevBtn" disabled>Previous</button>
                <!-- Page numbers will be inserted here by JavaScript -->
                <button class="pagination-btn" id="nextBtn">Next</button>
            </div>
        </div>
    </div>

    <!-- Notification element -->
    <div id="notification" class="notification"></div>

    <!-- Response Dialog -->
    <div id="responseDialog" class="confirmation-dialog">
        <div class="confirmation-content">
            <p id="dialogMessage">Respond to this issue report</p>
            <div class="form-group">
                <label for="responseStatus">Status:</label>
                <select id="responseStatus" class="form-control">
                    <option value="processing">Processing</option>
                    <option value="resolved">Resolved</option>
                </select>
            </div>
            <div class="form-group">
                <textarea id="customerResponse" placeholder="Enter your response..." cols="50" rows="5" class="form-control"></textarea>
            </div>
            <div class="confirmation-buttons">
                <button id="cancelResponse" class="cancel-btn"><i class="fas fa-times"></i> Cancel</button>
                <button id="confirmResponse" class="approve-btn"><i class="fas fa-check"></i> Submit Response</button>
            </div>
        </div>
    </div>

    <!-- Issue Details Modal -->
    <div id="issueDetailsModal" class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalIssueTitle">Issue Report Details</h2>
                <button id="closeIssueModal" class="close-modal">&times;</button>
            </div>
            <div id="modalIssueContent" class="modal-body">
                <!-- Dynamic content will load here -->
            </div>
        </div>
    </div>

    <!-- Logout Confirmation Dialog -->
    <div id="logoutDialog" class="confirmation-dialog">
        <div class="confirmation-content">
            <p>Are you sure you want to logout?</p>
            <div class="confirmation-buttons">
                <button id="cancelLogout" class="cancel-btn"><i class="fas fa-times"></i> Cancel</button>
                <button id="confirmLogout" class="reject-btn"><i class="fas fa-sign-out-alt"></i> Logout</button>
            </div>
        </div>
    </div>

    <!-- Overlay -->
    <div id="overlay" class="overlay"></div>

    <!-- Mobile Overlay -->
    <div class="sidebar-overlay"></div>

    <script src="/shopowner/js/issue_report.js" type="module"></script>
    <script>
        // Mobile sidebar toggle
        document.addEventListener('DOMContentLoaded', function() {
            const mobileToggle = document.querySelector('.mobile-menu-toggle');
            const sidebar = document.querySelector('.sidebar');
            const overlay = document.querySelector('.sidebar-overlay');
            
            if (mobileToggle) {
                mobileToggle.addEventListener('click', () => {
                    sidebar.classList.toggle('active');
                    overlay.classList.toggle('active');
                });
            }
            
            if (overlay) {
                overlay.addEventListener('click', () => {
                    sidebar.classList.remove('active');
                    overlay.classList.remove('active');
                });
            }

            // Make all thumbnail images clickable
            document.addEventListener('click', function(e) {
                if (e.target.classList.contains('photo-thumbnail')) {
                    e.stopPropagation();
                    window.open(e.target.src, '_blank');
                }
            });

            // Close modals when clicking outside
            document.addEventListener('click', function(event) {
                // For issue details modal
                const issueModal = document.getElementById('issueDetailsModal');
                if (event.target === issueModal) {
                    issueModal.classList.remove('show');
                    document.getElementById('overlay').classList.remove('show');
                }

                // For response dialog
                const responseDialog = document.getElementById('responseDialog');
                if (event.target === responseDialog) {
                    responseDialog.classList.remove('show');
                    document.getElementById('overlay').classList.remove('show');
                }

                // For logout dialog
                const logoutDialog = document.getElementById('logoutDialog');
                if (event.target === logoutDialog) {
                    logoutDialog.classList.remove('show');
                    document.getElementById('overlay').classList.remove('show');
                }
            });

            // Close buttons
            document.getElementById('closeIssueModal')?.addEventListener('click', function() {
                document.getElementById('issueDetailsModal').classList.remove('show');
                document.getElementById('overlay').classList.remove('show');
            });

            document.getElementById('cancelResponse')?.addEventListener('click', function() {
                document.getElementById('responseDialog').classList.remove('show');
                document.getElementById('overlay').classList.remove('show');
            });

            document.getElementById('cancelLogout')?.addEventListener('click', function() {
                document.getElementById('logoutDialog').classList.remove('show');
                document.getElementById('overlay').classList.remove('show');
            });
        });

        // Function to show modal with overlay
        function showModal(modalId) {
            document.getElementById(modalId).classList.add('show');
            document.getElementById('overlay').classList.add('show');
        }
    </script>
</body>
</html>